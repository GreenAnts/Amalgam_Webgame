<!DOCTYPE html>
<html lang="en">
<head>
<link rel="apple-touch-icon" sizes="57x57" href="../../assets/assets/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../assets/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../assets/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../assets/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../assets/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../assets/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../../assets/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../assets/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../assets/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../../assets/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../assets/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../assets/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../assets/favicon/favicon-16x16.png">
<link rel="manifest" href="../../assets/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Amalgam Board Game</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&family=DM+Mono&display=swap" rel="stylesheet">
<link rel="stylesheet" href="gameplay.css">
</head>

<body>
<div class="paper-overlay"></div>
<div class="ambient-container" id="ambientContainer"></div>

<div class="canvas-container">
	<canvas id="gameCanvas"></canvas>
</div>

<div class="side-panel">
	<div class="header">
		<div>
			<h1>Amalgam</h1>
			<div class="subtitle">A Two Player Abstract Strategy Board Game</div>
			<div class="subtitle">Open Source (GPLv3) · CC-BY 4.0</div>
		</div>
		<div style="display:flex;gap:8px;align-items:center;">
			<div class="theme-slider" id="toggleTheme" >
				<div class="theme-knob"></div>
			</div>
			<button class="icon-btn" id="openSettings" aria-label="Settings">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<circle cx="12" cy="12" r="3"/>
					<path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
				</svg>
			</button>
		</div>
	</div>

  <div class="player-box">
      <div class="player">
          <svg viewBox="0 0 24 24"><rect x="5" y="5" width="14" height="14" rx="2"/></svg>
          <p id="squarePlayerDisplay">Alice</p>
          <div class="turn-indicator active" id="squareIndicator">
              <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M16 5l-8 7 8 7V5z"/>
              </svg>
          </div>
      </div>
      <div id="turnCounterDisplay">Turn 1</div>
      <div class="player" style="flex-direction: row-reverse;">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="7"/></svg>
          <p id="circlePlayerDisplay">Bob</p>
          <div class="turn-indicator" id="circleIndicator">
              <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M8 5l8 7-8 7V5z"/>
              </svg>
          </div>
      </div>
  </div>

	<div class="section" style="flex:2;display:flex;flex-direction:column;min-height:0;">
		<div class="header" style="margin-bottom: 8px;">
	    <div class="section-title" style="margin-bottom: 0;">Log/Chat</div>

	    <div id="historyControls" style="display:flex; gap:6px;">
		    <button class="icon-btn" id="copyHistory" title="Copy Match History" style="width: 28px; height: 28px;">
			    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
				    <rect x="9" y="9" width="13" height="13" rx="2"/>
				    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
			    </svg>
		    </button>

		    <button class="icon-btn" id="toggleNotation" title="Toggle Notation" style="width: 28px; height: 28px;">
			    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" id="toggleIcon">
				    <path d="M16 18l6-6-6-6M8 6l-6 6 6 6" />
			    </svg>
		    </button>
	    </div>
    </div>

		<div style="display:flex;gap:6px;margin-bottom:6px;">
			<button class="tab-btn active" id="historyTab">History</button>
			<button class="tab-btn" id="chatTab">Chat</button>
		</div>
		<div class="log" id="matchHistory"></div>
		<div class="log" id="chatLog" style="display:none;"></div>
		<div class="chat-input" id="chatInput" style="display:none;">
			<input type="text" id="chatMessage" placeholder="Say something…">
			<button id="sendChat">Send</button>
		</div>
	</div>

	<div class="section">
		<div class="section-title">Actions</div>
		<div style="margin-bottom:10px;"><div class="actions"><button id="offerDrawBtn">Offer Draw</button><button id="forfeitBtn">Forfeit</button></div></div>
		<div style="margin-bottom:10px;"><div class="actions" style="grid-template-columns:1fr;"><button id="requestTakebackBtn">Request Takeback</button></div></div>
	</div>
	
	<div class="section">
		<div class="section-title">AI Strategy</div>

		<div class="difficulty-group" style="margin-bottom:10px;">
			<select class="difficulty-dropdown" id="aiDifficultyDropdown">
				<!-- All options loaded dynamically -->
			</select>
		</div>

		<div id="resetButton" class="actions" style="grid-template-columns:1fr;">
			<button class="danger-btn" id="restartGameBtn">Restart Game</button>
		</div>
	</div>
  
	<div class="footer"><a href="https://www.patreon.com/collection/787282?view=expanded" target="_blank" rel="noopener noreferrer">Amalgam Board Game</a> © 2026 by <a href="https://www.patreon.com/UnfinishedProjects" target="_blank" rel="noopener noreferrer">Anthony Davis</a> is licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer">CC BY 4.0</a><img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt="" style="max-width: 1em;max-height:1em;margin-left: .2em;"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt="" style="max-width: 1em;max-height:1em;margin-left: .2em;"></div>
	
</div>

<div class="settings-modal" id="settingsModal">
	<div class="settings-header"><h2>Settings</h2></div>
	<div class="settings-content">
		<div class="settings-section">
			<div class="section-title">Appearance</div>
			<div class="settings-row"><span>Theme</span><select><option>Light Tea</option><option>Evening Ink</option></select></div>
			<div class="settings-row"><span>Board Style</span><select><option>Wood</option><option>Stone</option><option>Paper</option></select></div>
		</div>
		<div class="settings-section">
			<div class="section-title">Sound</div>
			<div class="settings-row"><span>Ambient Tea Room</span><input type="checkbox" checked></div>
			<div class="settings-row"><span>Click Clacks</span><input type="checkbox" checked id="soundToggle"></div>
			<div class="settings-row"><span>Piece Placement</span><input type="checkbox" checked></div>
		</div>
		<div class="settings-section">
			<div class="section-title">Gameplay</div>
			<div class="settings-row"><span>Highlight Legal Moves</span><input type="checkbox" checked></div>
			<div class="settings-row"><span>Golden Embers</span><input type="checkbox" checked id="particleToggle"></div>
			<div class="settings-row"><span>Confirm Game-End Actions</span><input type="checkbox" checked></div>
		</div>
	</div>
	<div class="settings-footer"><button class="close-btn" id="closeSettings">Close Settings</button></div>
</div>

<div class="confirm-overlay" id="restartConfirmOverlay">
	<div class="confirm-callout">
		<div class="confirm-title">Restart Game</div>

		<div class="confirm-text">
			This will abandon the current match<br>
			and clear all progress.
		</div>

		<div class="confirm-actions">
			<button class="close-btn" id="cancelRestart">
				Continue Match
			</button>
			<button class="danger-btn" id="confirmRestart">
				Restart
			</button>
		</div>
	</div>
</div>

<div class="victory-overlay" id="victoryOverlay">
    <div class="victory-card" id="victoryCard">
        <div class="victory-inner">
            <button class="victory-close-btn" id="victoryCloseBtn" aria-label="Close victory popup">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
            </button>

            <button class="victory-copy-btn" id="victoryCopyBtn" title="Copy Match History">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2"/>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                </svg>
            </button>

            <div class="victory-icon" id="victoryIcon">
                </div>

            <div class="victory-header" id="victoryTitle">
                Match Complete
            </div>

            <div class="victory-details" id="victoryMessage">
                Winner determined.
            </div>

            <button class="victory-btn" id="victoryResetBtn">
                Play Again
            </button>
        </div>
    </div>
</div>

<!-- AI Strategy Change Confirmation -->
<div class="confirm-overlay" id="aiStrategyConfirmOverlay">
	<div class="confirm-callout">
		<div class="confirm-title">Change AI Strategy</div>

		<div class="confirm-text">
			This will change the AI difficulty for the current game and take effect immediately. The AI will use the new strategy for all remaining turns.
		</div>

		<div class="confirm-checkbox">
			<label>
				<input type="checkbox" id="aiStrategyDontAskAgain">
				Don't ask me again
			</label>
		</div>

		<div class="confirm-actions">
			<button class="close-btn" id="cancelAIStrategy">
				Cancel
			</button>
			<button class="danger-btn" id="confirmAIStrategy">
				Change Strategy
			</button>
		</div>
	</div>
</div>


<script src="gameplay.js"></script>
<!-- Import as ES6 modules -->
<script type="module" src="../../Main.js"></script>
</body>
</html>
